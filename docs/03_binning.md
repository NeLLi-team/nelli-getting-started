# Genome Binning

## Purpose
Genome binning groups contigs originating from the same organism so we can reconstruct draft genomes from metagenomic assemblies. The quality of bins determines how confidently we can assign taxonomy, functional annotations, and track strain-level dynamics.

## Inputs Required
- `assembly.fna` — contigs produced by SPAdes or another assembler.
- `depth.txt` — coverage table generated by `jgi_summarize_bam_contig_depths`.
- Optional paired-end reads (`clean_R1.fq.gz`, `clean_R2.fq.gz`) for SemiBin2 when using self-supervised models.

## Tools in This Repository

### MetaBAT2
- Uses tetranucleotide frequencies plus coverage to cluster contigs.
- Performs best when coverage varies across genomes; ensure depth profiles are accurate.

```bash
metabat2 \
  -i assembly.fna \
  -a depth.txt \
  -o bins_metabat2/bin
```

Key artefacts:
- `bins_metabat2/bin.*.fa` — draft genomes.
- `community_log.txt` — runtime summary, number of bins, average genome size.

### SemiBin2
- Self-supervised deep learning approach that can leverage read pairs for more nuanced clustering.
- Slower than MetaBAT2 on laptops but recovers difficult genomes more reliably.

```bash
SemiBin2 single_easy_bin \
  -i assembly.fna \
  -r clean_R1.fq.gz clean_R2.fq.gz \
  -o semibin2_out
```

Outputs include per-bin quality estimates and intermediate embeddings (`semibin2_out/log/`).

### QuickBin (BBTools)
- Very fast heuristic binning based on coverage and GC content; useful for sanity checks or when resources are constrained.

```bash
bash scripts/run_bbtools.sh quickbin.sh in=assembly.fna out=bins_quickbin/
```

## Evaluating Bins
- Run CheckM or BUSCO (not bundled here) to quantify completeness and contamination.
- Visualise differential coverage across samples once you move to real datasets; uniform coverage often signals high-quality bins.
- Any bin with mixed taxonomy or anomalous GC content should be revisited—consider manual curation or reassembly.

Document QC metrics alongside bin filenames when reporting results to the team.
